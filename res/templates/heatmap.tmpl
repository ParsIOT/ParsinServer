<!DOCTYPE html>
<html>

<head>
	<meta charset=utf-8/>
	<title>PARSIN</title>
	<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/static/img/favicon.ico"/>
	<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no'/>
	<!-- Bootstrap Core CSS -->
	<link href="/static/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom CSS -->
	<link href="/static/css/2-col-portfolio.css" rel="stylesheet">
	<link href="/static/css/custom.css" rel="stylesheet">
	<link href="/static/css/leaflet.css" rel="stylesheet">
	<link href="/static/css/leaflet.usermarker.css" rel="stylesheet">

	<!--
	<link href="/static/css/plugins/leaflet/heatmap/commons.css" rel="stylesheet">
	<link href="/static/css/plugins/leaflet/heatmap/prism.css" rel="stylesheet">  -->
	<link rel="stylesheet" type="text/css" href="/static/css/sweetalert.css">
	<!-- Font Awesome CSS -->
	<link rel="stylesheet" href="/static/css/font-awesome.min.css">
	<style>
		#live-map {
			height: 500px;
		}

		#locations-table-container {
			overflow: scroll;
		}
	</style>
</head>

<body>

{{ template "navbar" . }}

<!-- Page Content -->
<div class="container-fluid">

	<div class="row">
		<div class="col-lg-12">
			<h2 class="page-header">Trace Route Map
				<small>view users tracking history on map</small>
			</h2>
		</div>
	</div>

	<!--<div class="well">-->
	<div class="row">
		<div class="col-md-9 col-sm-12">
			<div class="panel panel-primary" id="map-panel">
				<div class="panel-heading">
					Map
				</div>
				<div class="panel-body">
					<div id="heat-map"></div>

				</div>
			</div>
		</div>
		<div class="col-md-3 col-sm-12">
			<div class="panel panel-success" id="users-list-panel">
				<div class="panel-heading">
					Users
				</div>
				<div class="panel-body" id="locations-table-container">
					<div class="bs-callout bs-callout-info row" style="margin: 0 0 15px;">
						<div class="col-md-12">
							<a href="#location" data-toggle="collapse"><h4 style="text-decoration: underline;">
								Select Location</h4></a>
							<div id="location" class="collapse in">
								<div class="form-group">
									<label for="refresh-interval">Enter location</label>
									<input id="locName" class="form-control" placeholder="Location Num"/>
								</div>
								<div class="form-group">
									<label for="refresh-interval">Enter MaxFPDist(0 to 50.0)</label>
									<input id="maxFPDist" class="form-control" placeholder="Max RSS Vector distance"
									       value="5"/>
								</div>
								<div class="col-md-12">
									<div class="form-group">
										<button id="get-similar-fp" onclick="getFPAmbiguity()"
										        class="btn btn-success btn-block">
											Get similar FP
										</button>
										<button id="resetMapBtn" onclick="getMapLocations()"
										        class="btn btn-warning btn-block">
											Reset Map
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<table id="locations-table"
					       class="table table-responsive table-hover table-condensed table-bordered">
						<thead>
						<tr>
							<td>Location</td>
							<td>Num</td>
						</tr>
						</thead>
					</table>
					<h4 id="show-details-link" class="text-center"/>
				</div>
			</div>
		</div>
	</div>
	<!--</div>-->


</div>

<!-- Bootstrap and JQuery JS -->
<script src="/static/js/jquery-2.0.0.min.js"></script>
<script src='/static/js/bootstrap.js'></script>
<script src='/static/js/leaflet.js'></script>
<!-- <script src="/static/js/heatmap.js"></script> -->
<!-- leaflet heatmap JS -->
<!-- <script src="/static/js/leaflet-heatmap.js"></script>
<script src="/static/js/plugins/leaflet/heatmap/prism.js"></script>  -->


<script src='/static/js/leaflet.usermarker.js'></script>
<script src='/static/js/Leaflet.Marker.SlideTo.js'></script>
<script src="/static/js/sweetalert.min.js"></script>
<script src="/static/js/d3.min.js"></script>
<script src="/static/js/d3.tip.v0.6.3.js"></script>
{{/*
<script src="/static/js/plugins/leaflet/heatmap/leaflet-heat.js"></script>
*/}}
{{/*
<script src="/static/js/plugins/leaflet/heatmap/HeatLayer.js"></script>
*/}}
<script src="/static/js/plugins/leaflet/heatmap/leaflet-div-heatmap.js"></script>

{{/*
<script src="/static/js/plugins/leaflet/heatmap/heatmap.min.js"></script>
*/}}
{{/*
<script src="/static/js/plugins/leaflet/heatmap/leaflet-heatmap.js"></script>
*/}}

<script type="application/javascript">
	var filter_user = false;
	var reloadDataInterval;


	$('#heat-map').css('height', $(window.top).height() - 275);
	$('#locations-table-container').css('height', $(window.top).height() - 245);


	var map = L.map('heat-map', {
		crs: L.CRS.Simple,
		minZoom: -100,
//        maxZoom: 4
		//layers: [baseLayer, heatmapLayer] //heatmap
	});
	var bounds = [[-1 * ('{{.MapHeight}}' / 2), -1 * ('{{.MapWidth}}' / 2)], [('{{.MapHeight}}' / 2), ('{{.MapWidth}}' / 2)]];
	//    var bounds = [[-400, -300], [400, 300]];
	var image = L.imageOverlay('{{.MapPath}}', bounds).addTo(map);
	map.setView([0, 0], -2);


	my_data = [
		{lat: -20, lng: -30, value: 0, opacity: 1},
		{lat: -20, lng: -15, value: 10, opacity: 1},
		{lat: -20, lng: 0, value: 20, opacity: 1},
		{lat: -20, lng: 15, value: 30, opacity: 1},
		{lat: -20, lng: 30, value: 40, opacity: 1},
		{lat: -30, lng: 45, value: 50, opacity: 1},
		{lat: 20, lng: -30, value: 60, opacity: 1},
		{lat: 20, lng: -15, value: 70, opacity: 1},
		{lat: 20, lng: 0, value: 80, opacity: 1},
		{lat: 20, lng: 15, value: 90, opacity: 1},
		{lat: 20, lng: 30, value: 100, opacity: 1}
	];
	var map = L.map('map').setView([35.70132428054478, 51.40498638153076], 14);

	// http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
	L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
		maxZoom: 18,
	}).addTo(map);

	var heatmap = new L.MultiColorDivHeatmapLayer({radius: 100}, true);

	heatmap.addTo(map);

	heatmap.setData(my_data);

	map.on('click', function (e) {
		console.log(e.latlng.lat + ',' + e.latlng.lng)
	});

</script>

</body>

</html>
